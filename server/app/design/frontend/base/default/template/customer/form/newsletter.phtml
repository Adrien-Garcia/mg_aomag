<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

// Récupération des centre d'intérets disponible
$formlist = Mage::helper('newsletterdolist')->load();
// Récupération des centre d'intérêts du client
$interests = explode(";",$this->getCustomer()->getInterests());

?>
<div class="page-title">
    <h1><?php echo $this->__('Newsletter Subscription') ?></h1>
</div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<?php echo $this->getChildHtml('form_before')?>
<form action="<?php echo $this->getAction() ?>" method="post" id="form-validate">
    <div class="fieldset">
        <?php echo $this->getBlockHtml('formkey')?>
        <h2 class="legend"><?php echo $this->__('Newsletter Subscription') ?></h2>
        <ul class="form-list">
            <li class="control"><input type="checkbox" name="is_subscribed" id="subscription" value="1" title="<?php echo $this->__('General Subscription') ?>"<?php if($this->getIsSubscribed()): ?> checked="checked"<?php endif; ?> class="checkbox"  onchange="showhide_centresinterets();"/><label for="subscription"><?php echo $this->__('General Subscription') ?></label></li>
            <?php if(isset($formlist[0])): ?>
			 	<div id="newsletterdolist_centresinterets">
					<p>Les differents centres d'intérets :</p> 
					<?php foreach($formlist[0] as $key => $value):?>
					<li class="control">				
						<input type="checkbox" name="centreinteret_<?php echo $key?>" id="centreinteret_<?php echo $key?>" value="1" <?php if(in_array($key,$interests)) echo "checked='checked'";  ?>title="<?php echo $this->__('General Subscription') ?>"  class="checkbox"/>
						<label for="centre_interet"><?php echo $value; ?></label>					
					</li>
					<?php endforeach;?>	 
				</div>
			<script type="text/javascript">	
			function showhide_centresinterets(){		
				var inscrit = jQuery('#subscription:checked').val();
				if(inscrit == 1){			
					jQuery('#newsletterdolist_centresinterets').slideDown();
				} else {
					jQuery('#newsletterdolist_centresinterets').slideUp();
				} 
			}
			showhide_centresinterets();
			</script>
			<?php endif; ?>
        </ul>
    </div>
    <div class="buttons-set">
        <p class="back-link"><a href="<?php echo $this->escapeUrl($this->getBackUrl()) ?>"><small>&laquo; </small><?php echo $this->__('Back') ?></a></p>
        <button type="submit" title="<?php echo $this->__('Save') ?>" class="button"><span><span><?php echo $this->__('Save') ?></span></span></button>
    </div>
</form>
<script type="text/javascript">
//<![CDATA[
    var dataForm = new VarienForm('form-validate', true);
//]]>
</script>
