web:
    container_name: mg_aomagento-web
    image: registry.jetpulp.fr:5000/dev/php70-apache
    ports:
        - "80:80"
    volumes:
        - ../server:/var/www/mg_aomagento
        - ./web/vhost.conf:/etc/apache2/sites-enabled/vhost.conf
        - ./web/php.ini:/usr/local/etc/php/php.ini
    environment:
        - ALLOW_OVERRIDE=true
        - SERVER_NAME
        - USER_UID
        - USER_GROUP
        - DOCKER_MACHINE_NAME
    links:
        - db:db
        - mailhog:mailhog
        - blackfire:blackfire
#        - redis:redis
db:
    container_name: mg_aomagento-db
    image: mariadb:10.0
    ports:
        - "3306:3306"
    volumes:
        - ./db:/docker-entrypoint-initdb.d
    volumes_from:
        - mg_aomagento-dbdata
    environment:
        - MYSQL_ROOT_PASSWORD=root
        - MYSQL_DATABASE
        - SERVER_NAME
        - ORIGINAL_SERVER_NAME
#redis:
#    container_name: mg_aomagento-redis
#    image: redis
#    ports:
#        - "6379"
mailhog:
    container_name: mailhog
    image: mailhog/mailhog
    ports:
        - "8025:8025"
blackfire:
    container_name: blackfire
    image: blackfire/blackfire
    environment:
        - BLACKFIRE_SERVER_ID
        - BLACKFIRE_SERVER_TOKEN
gulp:
    container_name: gulp
    image: registry.jetpulp.fr:5000/dev/gulp-dev
    ports:
        - "3000:3000"
        - "3001:3001"
    volumes:
        - ../server:/app
    environment:
        - BUILD_PATH=skin/frontend/COMPUTEC/default/gulp
#        - BUILD_PATH=skin/frontend/BRANDER/default/gulp
#        - BUILD_PATH=skin/frontend/ANGLECIA/default/gulp
        - SERVER_NAME
        - USER_UID
        - USER_GROUP